{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_blob_bsmt_csv",
						"type": "DatasetReference"
					},
					"name": "bsmt"
				},
				{
					"dataset": {
						"referenceName": "ds_blob_garage_csv",
						"type": "DatasetReference"
					},
					"name": "garage"
				},
				{
					"dataset": {
						"referenceName": "ds_blob_misc_csv",
						"type": "DatasetReference"
					},
					"name": "misc"
				},
				{
					"dataset": {
						"referenceName": "ds_blob_pool_csv",
						"type": "DatasetReference"
					},
					"name": "pool"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "bstmgarage"
				},
				{
					"name": "bstmgaragemisc"
				},
				{
					"name": "finalunido"
				},
				{
					"name": "select1"
				},
				{
					"name": "wnduplicados"
				},
				{
					"name": "filterduplicados"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "select2"
				}
			],
			"scriptLines": [
				"source(output(",
				"          PID as integer,",
				"          {Bsmt Qual} as string,",
				"          {Bsmt Cond} as string,",
				"          {Bsmt Exposure} as string,",
				"          {BsmtFin Type 1} as string,",
				"          {BsmtFin SF 1} as integer,",
				"          {BsmtFin Type 2} as string,",
				"          {BsmtFin SF 2} as integer,",
				"          {Bsmt Unf SF} as integer,",
				"          {Total Bsmt SF} as integer,",
				"          {Bsmt Full Bath} as integer,",
				"          {Bsmt Half Bath} as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> bsmt",
				"source(output(",
				"          Order as integer,",
				"          PID as integer,",
				"          {Garage Type} as string,",
				"          {Garage Yr Blt} as integer,",
				"          {Garage Finish} as string,",
				"          {Garage Cars} as integer,",
				"          {Garage Area} as integer,",
				"          {Garage Qual} as string,",
				"          {Garage Cond} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> garage",
				"source(output(",
				"          PID as integer,",
				"          {Misc Feature} as string,",
				"          {Misc Val} as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> misc",
				"source(output(",
				"          PID as integer,",
				"          {Pool Area} as integer,",
				"          {Pool QC} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> pool",
				"bsmt, garage join(bsmt@PID == garage@PID,",
				"     joinType:'outer',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> bstmgarage",
				"bstmgarage, misc join(bsmt@PID == misc@PID,",
				"     joinType:'outer',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> bstmgaragemisc",
				"bstmgaragemisc, pool join(bsmt@PID == pool@PID,",
				"     joinType:'outer',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> finalunido",
				"finalunido select(mapColumn(",
				"          PID = bsmt@PID,",
				"          {Bsmt Qual},",
				"          {Bsmt Cond},",
				"          {Bsmt Exposure},",
				"          {BsmtFin Type 1},",
				"          {BsmtFin SF 1},",
				"          {BsmtFin Type 2},",
				"          {BsmtFin SF 2},",
				"          {Bsmt Unf SF},",
				"          {Total Bsmt SF},",
				"          {Bsmt Full Bath},",
				"          {Bsmt Half Bath},",
				"          Order,",
				"          {Garage Type},",
				"          {Garage Yr Blt},",
				"          {Garage Finish},",
				"          {Garage Cars},",
				"          {Garage Area},",
				"          {Garage Qual},",
				"          {Garage Cond},",
				"          {Misc Feature},",
				"          {Misc Val},",
				"          {Pool Area},",
				"          {Pool QC}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 window(over(PID),",
				"     asc(PID, true),",
				"     row_num = rowNumber()) ~> wnduplicados",
				"wnduplicados filter(row_num == 1) ~> filterduplicados",
				"select2 derive({Bsmt Qual} = iif(isNull({Bsmt Qual}), 'NA', {Bsmt Qual}),",
				"          {Bsmt Cond} = iif(isNull({Bsmt Cond}), 'NA', {Bsmt Cond}),",
				"          {Bsmt Exposure} = iif(isNull({Bsmt Exposure}), 'NA', {Bsmt Exposure}),",
				"          {BsmtFin Type 1} = iif(isNull({BsmtFin Type 1}), 'NA', {BsmtFin Type 1}),",
				"          {BsmtFin SF 1} = iif(isNull({BsmtFin SF 1}), 0, {BsmtFin SF 1}),",
				"          {BsmtFin Type 2} = iif(isNull({BsmtFin Type 2}), 'NA', {BsmtFin Type 2}),",
				"          {BsmtFin SF 2} = iif(isNull({BsmtFin SF 2}), 0, {BsmtFin SF 2}),",
				"          {Bsmt Unf SF} = iif(isNull({Bsmt Unf SF}), 0, {Bsmt Unf SF}),",
				"          {Total Bsmt SF} = iif(isNull({Total Bsmt SF}), 0, {Total Bsmt SF}),",
				"          {Bsmt Full Bath} = iif(isNull({Bsmt Full Bath}), 0, {Bsmt Full Bath}),",
				"          {Bsmt Half Bath} = iif(isNull({Bsmt Half Bath}), 0, {Bsmt Half Bath}),",
				"          {Garage Type} = iif(isNull({Garage Type}), 'NA', {Garage Type}),",
				"          {Garage Yr Blt} = iif(isNull({Garage Yr Blt}), 0, {Garage Yr Blt}),",
				"          {Garage Finish} = iif(isNull({Garage Finish}), 'NA', {Garage Finish}),",
				"          {Garage Cars} = iif(isNull({Garage Cars}), 0, {Garage Cars}),",
				"          {Garage Area} = iif(isNull({Garage Area}), 0, {Garage Area}),",
				"          {Garage Qual} = iif(isNull({Garage Qual}), 'NA', {Garage Qual}),",
				"          {Garage Cond} = iif(isNull({Garage Cond}), 'NA', {Garage Cond}),",
				"          {Misc Feature} = iif(isNull({Misc Feature}), 'NA', {Misc Feature}),",
				"          {Misc Val} = iif(isNull({Misc Val}), 0, {Misc Val}),",
				"          {Pool Area} = iif(isNull({Pool Area}), 0, {Pool Area}),",
				"          {Pool QC} = iif(isNull({Pool QC}), 'NA', {Pool QC})) ~> derivedColumn1",
				"filterduplicados select(mapColumn(",
				"          PID,",
				"          {Bsmt Qual},",
				"          {Bsmt Cond},",
				"          {Bsmt Exposure},",
				"          {BsmtFin Type 1},",
				"          {BsmtFin SF 1},",
				"          {BsmtFin Type 2},",
				"          {BsmtFin SF 2},",
				"          {Bsmt Unf SF},",
				"          {Total Bsmt SF},",
				"          {Bsmt Full Bath},",
				"          {Bsmt Half Bath},",
				"          Order,",
				"          {Garage Type},",
				"          {Garage Yr Blt},",
				"          {Garage Finish},",
				"          {Garage Cars},",
				"          {Garage Area},",
				"          {Garage Qual},",
				"          {Garage Cond},",
				"          {Misc Feature},",
				"          {Misc Val},",
				"          {Pool Area},",
				"          {Pool QC}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2"
			]
		}
	}
}